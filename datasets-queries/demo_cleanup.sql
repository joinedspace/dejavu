with ar as (SELECT 'ArbutusRidge' AS locale,
       MAX(CASE WHEN ID = 94 THEN ArbutusRidge END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN ArbutusRidge END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN ArbutusRidge END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN ArbutusRidge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN ArbutusRidge END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN ArbutusRidge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN ArbutusRidge END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN ArbutusRidge END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN ArbutusRidge END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN ArbutusRidge END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN ArbutusRidge END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN ArbutusRidge END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN ArbutusRidge END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN ArbutusRidge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN ArbutusRidge END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN ArbutusRidge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN ArbutusRidge END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN ArbutusRidge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN ArbutusRidge END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN ArbutusRidge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN ArbutusRidge END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN ArbutusRidge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN ArbutusRidge END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN ArbutusRidge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN ArbutusRidge END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then ArbutusRidge end) as float) / cast(max(case when ID = 2477 then ArbutusRidge end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then ArbutusRidge end) as float) / cast(max(case when ID = 2477 then ArbutusRidge end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then ArbutusRidge end) as float) / cast(max(case when ID = 2477 then ArbutusRidge end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then ArbutusRidge end) as float) / cast(max(case when ID = 2477 then ArbutusRidge end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then ArbutusRidge end) as float) / cast(max(case when ID = 2477 then ArbutusRidge end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_black,
       cast(max(case when ID = 3085 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_arab,
       cast(max(case when ID = 3088 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_korean,
       cast(max(case when ID = 3091 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then ArbutusRidge end) as float) / cast(max(case when ID = 3094 then ArbutusRidge end) + max(case when ID = 3081 then ArbutusRidge end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then ArbutusRidge end) as float) / cast(max(case when ID = 4018 then ArbutusRidge end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then ArbutusRidge end) as float) / cast(max(case when ID = 4018 then ArbutusRidge end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then ArbutusRidge end) as float) / cast(max(case when ID = 4042 then ArbutusRidge end) + max(case when ID = 4043 then ArbutusRidge end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then ArbutusRidge end) as float) / cast(max(case when ID = 4042 then ArbutusRidge end) + max(case when ID = 4043 then ArbutusRidge end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then ArbutusRidge end) as float) / cast(max(case when ID = 4093 then ArbutusRidge end) + max(case when ID = 4094 then ArbutusRidge end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then ArbutusRidge end) as float) / cast(max(case when ID = 4093 then ArbutusRidge end) + max(case when ID = 4094 then ArbutusRidge end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then ArbutusRidge end) as median_rent,
       max(case when ID = 4107 then ArbutusRidge end) as average_rent,
       cast(max(case when ID = 4109 then ArbutusRidge end) as float) / cast(max(case when ID = 4108 then ArbutusRidge end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then ArbutusRidge end) as float) / cast(max(case when ID = 4108 then ArbutusRidge end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then ArbutusRidge end) as float) / cast(max(case when ID = 4108 then ArbutusRidge end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then ArbutusRidge end) as float) / cast(max(case when ID = 4108 then ArbutusRidge end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then ArbutusRidge end) as float) / cast(max(case when ID = 4108 then ArbutusRidge end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then ArbutusRidge end) as float) / cast(max(case when ID = 4108 then ArbutusRidge end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then ArbutusRidge end) as float) / cast(max(case when ID = 4108 then ArbutusRidge end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
dt as (SELECT 'Downtown' AS locale,
       MAX(CASE WHEN ID = 94 THEN Downtown END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Downtown END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Downtown END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Downtown END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Downtown END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Downtown END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Downtown END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Downtown END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Downtown END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Downtown END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Downtown END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Downtown END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Downtown END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Downtown END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Downtown END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Downtown END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Downtown END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Downtown END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Downtown END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Downtown END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Downtown END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Downtown END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Downtown END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Downtown END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Downtown END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Downtown end) as float) / cast(max(case when ID = 2477 then Downtown end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Downtown end) as float) / cast(max(case when ID = 2477 then Downtown end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Downtown end) as float) / cast(max(case when ID = 2477 then Downtown end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Downtown end) as float) / cast(max(case when ID = 2477 then Downtown end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Downtown end) as float) / cast(max(case when ID = 2477 then Downtown end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_black,
       cast(max(case when ID = 3085 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Downtown end) as float) / cast(max(case when ID = 3094 then Downtown end) + max(case when ID = 3081 then Downtown end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Downtown end) as float) / cast(max(case when ID = 4018 then Downtown end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Downtown end) as float) / cast(max(case when ID = 4018 then Downtown end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Downtown end) as float) / cast(max(case when ID = 4042 then Downtown end) + max(case when ID = 4043 then Downtown end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Downtown end) as float) / cast(max(case when ID = 4042 then Downtown end) + max(case when ID = 4043 then Downtown end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Downtown end) as float) / cast(max(case when ID = 4093 then Downtown end) + max(case when ID = 4094 then Downtown end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Downtown end) as float) / cast(max(case when ID = 4093 then Downtown end) + max(case when ID = 4094 then Downtown end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Downtown end) as median_rent,
       max(case when ID = 4107 then Downtown end) as average_rent,
       cast(max(case when ID = 4109 then Downtown end) as float) / cast(max(case when ID = 4108 then Downtown end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Downtown end) as float) / cast(max(case when ID = 4108 then Downtown end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Downtown end) as float) / cast(max(case when ID = 4108 then Downtown end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Downtown end) as float) / cast(max(case when ID = 4108 then Downtown end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Downtown end) as float) / cast(max(case when ID = 4108 then Downtown end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Downtown end) as float) / cast(max(case when ID = 4108 then Downtown end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Downtown end) as float) / cast(max(case when ID = 4108 then Downtown end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
ds as (SELECT 'DunbarSouthlands' AS locale,
       MAX(CASE WHEN ID = 94 THEN DunbarSouthlands END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN DunbarSouthlands END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN DunbarSouthlands END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN DunbarSouthlands END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN DunbarSouthlands END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN DunbarSouthlands END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN DunbarSouthlands END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN DunbarSouthlands END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN DunbarSouthlands END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN DunbarSouthlands END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN DunbarSouthlands END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN DunbarSouthlands END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN DunbarSouthlands END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN DunbarSouthlands END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN DunbarSouthlands END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN DunbarSouthlands END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN DunbarSouthlands END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN DunbarSouthlands END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN DunbarSouthlands END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN DunbarSouthlands END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN DunbarSouthlands END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN DunbarSouthlands END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN DunbarSouthlands END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN DunbarSouthlands END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN DunbarSouthlands END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then DunbarSouthlands end) as float) / cast(max(case when ID = 2477 then DunbarSouthlands end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then DunbarSouthlands end) as float) / cast(max(case when ID = 2477 then DunbarSouthlands end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then DunbarSouthlands end) as float) / cast(max(case when ID = 2477 then DunbarSouthlands end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then DunbarSouthlands end) as float) / cast(max(case when ID = 2477 then DunbarSouthlands end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then DunbarSouthlands end) as float) / cast(max(case when ID = 2477 then DunbarSouthlands end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_black,
       cast(max(case when ID = 3085 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_arab,
       cast(max(case when ID = 3088 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_korean,
       cast(max(case when ID = 3091 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then DunbarSouthlands end) as float) / cast(max(case when ID = 3094 then DunbarSouthlands end) + max(case when ID = 3081 then DunbarSouthlands end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then DunbarSouthlands end) as float) / cast(max(case when ID = 4018 then DunbarSouthlands end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then DunbarSouthlands end) as float) / cast(max(case when ID = 4018 then DunbarSouthlands end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then DunbarSouthlands end) as float) / cast(max(case when ID = 4042 then DunbarSouthlands end) + max(case when ID = 4043 then DunbarSouthlands end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then DunbarSouthlands end) as float) / cast(max(case when ID = 4042 then DunbarSouthlands end) + max(case when ID = 4043 then DunbarSouthlands end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then DunbarSouthlands end) as float) / cast(max(case when ID = 4093 then DunbarSouthlands end) + max(case when ID = 4094 then DunbarSouthlands end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then DunbarSouthlands end) as float) / cast(max(case when ID = 4093 then DunbarSouthlands end) + max(case when ID = 4094 then DunbarSouthlands end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then DunbarSouthlands end) as median_rent,
       max(case when ID = 4107 then DunbarSouthlands end) as average_rent,
       cast(max(case when ID = 4109 then DunbarSouthlands end) as float) / cast(max(case when ID = 4108 then DunbarSouthlands end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then DunbarSouthlands end) as float) / cast(max(case when ID = 4108 then DunbarSouthlands end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then DunbarSouthlands end) as float) / cast(max(case when ID = 4108 then DunbarSouthlands end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then DunbarSouthlands end) as float) / cast(max(case when ID = 4108 then DunbarSouthlands end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then DunbarSouthlands end) as float) / cast(max(case when ID = 4108 then DunbarSouthlands end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then DunbarSouthlands end) as float) / cast(max(case when ID = 4108 then DunbarSouthlands end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then DunbarSouthlands end) as float) / cast(max(case when ID = 4108 then DunbarSouthlands end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
fv as (SELECT 'Fairview' AS locale,
       MAX(CASE WHEN ID = 94 THEN Fairview END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Fairview END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Fairview END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Fairview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Fairview END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Fairview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Fairview END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Fairview END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Fairview END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Fairview END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Fairview END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Fairview END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Fairview END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Fairview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Fairview END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Fairview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Fairview END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Fairview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Fairview END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Fairview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Fairview END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Fairview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Fairview END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Fairview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Fairview END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Fairview end) as float) / cast(max(case when ID = 2477 then Fairview end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Fairview end) as float) / cast(max(case when ID = 2477 then Fairview end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Fairview end) as float) / cast(max(case when ID = 2477 then Fairview end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Fairview end) as float) / cast(max(case when ID = 2477 then Fairview end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Fairview end) as float) / cast(max(case when ID = 2477 then Fairview end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_black,
       cast(max(case when ID = 3085 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Fairview end) as float) / cast(max(case when ID = 3094 then Fairview end) + max(case when ID = 3081 then Fairview end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Fairview end) as float) / cast(max(case when ID = 4018 then Fairview end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Fairview end) as float) / cast(max(case when ID = 4018 then Fairview end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Fairview end) as float) / cast(max(case when ID = 4042 then Fairview end) + max(case when ID = 4043 then Fairview end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Fairview end) as float) / cast(max(case when ID = 4042 then Fairview end) + max(case when ID = 4043 then Fairview end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Fairview end) as float) / cast(max(case when ID = 4093 then Fairview end) + max(case when ID = 4094 then Fairview end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Fairview end) as float) / cast(max(case when ID = 4093 then Fairview end) + max(case when ID = 4094 then Fairview end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Fairview end) as median_rent,
       max(case when ID = 4107 then Fairview end) as average_rent,
       cast(max(case when ID = 4109 then Fairview end) as float) / cast(max(case when ID = 4108 then Fairview end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Fairview end) as float) / cast(max(case when ID = 4108 then Fairview end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Fairview end) as float) / cast(max(case when ID = 4108 then Fairview end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Fairview end) as float) / cast(max(case when ID = 4108 then Fairview end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Fairview end) as float) / cast(max(case when ID = 4108 then Fairview end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Fairview end) as float) / cast(max(case when ID = 4108 then Fairview end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Fairview end) as float) / cast(max(case when ID = 4108 then Fairview end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
gw as (SELECT 'GrandviewWoodland' AS locale,
       MAX(CASE WHEN ID = 94 THEN GrandviewWoodland END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN GrandviewWoodland END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN GrandviewWoodland END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN GrandviewWoodland END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN GrandviewWoodland END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN GrandviewWoodland END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN GrandviewWoodland END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN GrandviewWoodland END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN GrandviewWoodland END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN GrandviewWoodland END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN GrandviewWoodland END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN GrandviewWoodland END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN GrandviewWoodland END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN GrandviewWoodland END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN GrandviewWoodland END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN GrandviewWoodland END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN GrandviewWoodland END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN GrandviewWoodland END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN GrandviewWoodland END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN GrandviewWoodland END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN GrandviewWoodland END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN GrandviewWoodland END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN GrandviewWoodland END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN GrandviewWoodland END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN GrandviewWoodland END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then GrandviewWoodland end) as float) / cast(max(case when ID = 2477 then GrandviewWoodland end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then GrandviewWoodland end) as float) / cast(max(case when ID = 2477 then GrandviewWoodland end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then GrandviewWoodland end) as float) / cast(max(case when ID = 2477 then GrandviewWoodland end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then GrandviewWoodland end) as float) / cast(max(case when ID = 2477 then GrandviewWoodland end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then GrandviewWoodland end) as float) / cast(max(case when ID = 2477 then GrandviewWoodland end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_black,
       cast(max(case when ID = 3085 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_arab,
       cast(max(case when ID = 3088 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_korean,
       cast(max(case when ID = 3091 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then GrandviewWoodland end) as float) / cast(max(case when ID = 3094 then GrandviewWoodland end) + max(case when ID = 3081 then GrandviewWoodland end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then GrandviewWoodland end) as float) / cast(max(case when ID = 4018 then GrandviewWoodland end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then GrandviewWoodland end) as float) / cast(max(case when ID = 4018 then GrandviewWoodland end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then GrandviewWoodland end) as float) / cast(max(case when ID = 4042 then GrandviewWoodland end) + max(case when ID = 4043 then GrandviewWoodland end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then GrandviewWoodland end) as float) / cast(max(case when ID = 4042 then GrandviewWoodland end) + max(case when ID = 4043 then GrandviewWoodland end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then GrandviewWoodland end) as float) / cast(max(case when ID = 4093 then GrandviewWoodland end) + max(case when ID = 4094 then GrandviewWoodland end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then GrandviewWoodland end) as float) / cast(max(case when ID = 4093 then GrandviewWoodland end) + max(case when ID = 4094 then GrandviewWoodland end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then GrandviewWoodland end) as median_rent,
       max(case when ID = 4107 then GrandviewWoodland end) as average_rent,
       cast(max(case when ID = 4109 then GrandviewWoodland end) as float) / cast(max(case when ID = 4108 then GrandviewWoodland end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then GrandviewWoodland end) as float) / cast(max(case when ID = 4108 then GrandviewWoodland end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then GrandviewWoodland end) as float) / cast(max(case when ID = 4108 then GrandviewWoodland end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then GrandviewWoodland end) as float) / cast(max(case when ID = 4108 then GrandviewWoodland end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then GrandviewWoodland end) as float) / cast(max(case when ID = 4108 then GrandviewWoodland end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then GrandviewWoodland end) as float) / cast(max(case when ID = 4108 then GrandviewWoodland end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then GrandviewWoodland end) as float) / cast(max(case when ID = 4108 then GrandviewWoodland end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
hs as (SELECT 'HastingsSunrise' AS locale,
       MAX(CASE WHEN ID = 94 THEN HastingsSunrise END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN HastingsSunrise END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN HastingsSunrise END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN HastingsSunrise END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN HastingsSunrise END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN HastingsSunrise END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN HastingsSunrise END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN HastingsSunrise END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN HastingsSunrise END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN HastingsSunrise END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN HastingsSunrise END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN HastingsSunrise END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN HastingsSunrise END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN HastingsSunrise END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN HastingsSunrise END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN HastingsSunrise END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN HastingsSunrise END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN HastingsSunrise END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN HastingsSunrise END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN HastingsSunrise END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN HastingsSunrise END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN HastingsSunrise END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN HastingsSunrise END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN HastingsSunrise END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN HastingsSunrise END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then HastingsSunrise end) as float) / cast(max(case when ID = 2477 then HastingsSunrise end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then HastingsSunrise end) as float) / cast(max(case when ID = 2477 then HastingsSunrise end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then HastingsSunrise end) as float) / cast(max(case when ID = 2477 then HastingsSunrise end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then HastingsSunrise end) as float) / cast(max(case when ID = 2477 then HastingsSunrise end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then HastingsSunrise end) as float) / cast(max(case when ID = 2477 then HastingsSunrise end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_black,
       cast(max(case when ID = 3085 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_arab,
       cast(max(case when ID = 3088 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_korean,
       cast(max(case when ID = 3091 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then HastingsSunrise end) as float) / cast(max(case when ID = 3094 then HastingsSunrise end) + max(case when ID = 3081 then HastingsSunrise end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then HastingsSunrise end) as float) / cast(max(case when ID = 4018 then HastingsSunrise end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then HastingsSunrise end) as float) / cast(max(case when ID = 4018 then HastingsSunrise end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then HastingsSunrise end) as float) / cast(max(case when ID = 4042 then HastingsSunrise end) + max(case when ID = 4043 then HastingsSunrise end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then HastingsSunrise end) as float) / cast(max(case when ID = 4042 then HastingsSunrise end) + max(case when ID = 4043 then HastingsSunrise end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then HastingsSunrise end) as float) / cast(max(case when ID = 4093 then HastingsSunrise end) + max(case when ID = 4094 then HastingsSunrise end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then HastingsSunrise end) as float) / cast(max(case when ID = 4093 then HastingsSunrise end) + max(case when ID = 4094 then HastingsSunrise end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then HastingsSunrise end) as median_rent,
       max(case when ID = 4107 then HastingsSunrise end) as average_rent,
       cast(max(case when ID = 4109 then HastingsSunrise end) as float) / cast(max(case when ID = 4108 then HastingsSunrise end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then HastingsSunrise end) as float) / cast(max(case when ID = 4108 then HastingsSunrise end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then HastingsSunrise end) as float) / cast(max(case when ID = 4108 then HastingsSunrise end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then HastingsSunrise end) as float) / cast(max(case when ID = 4108 then HastingsSunrise end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then HastingsSunrise end) as float) / cast(max(case when ID = 4108 then HastingsSunrise end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then HastingsSunrise end) as float) / cast(max(case when ID = 4108 then HastingsSunrise end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then HastingsSunrise end) as float) / cast(max(case when ID = 4108 then HastingsSunrise end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
kcc as (SELECT 'KensingtonCedarCottage' AS locale,
       MAX(CASE WHEN ID = 94 THEN KensingtonCedarCottage END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN KensingtonCedarCottage END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN KensingtonCedarCottage END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN KensingtonCedarCottage END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN KensingtonCedarCottage END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN KensingtonCedarCottage END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN KensingtonCedarCottage END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN KensingtonCedarCottage END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN KensingtonCedarCottage END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN KensingtonCedarCottage END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN KensingtonCedarCottage END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN KensingtonCedarCottage END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN KensingtonCedarCottage END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN KensingtonCedarCottage END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN KensingtonCedarCottage END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN KensingtonCedarCottage END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN KensingtonCedarCottage END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN KensingtonCedarCottage END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN KensingtonCedarCottage END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN KensingtonCedarCottage END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN KensingtonCedarCottage END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN KensingtonCedarCottage END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN KensingtonCedarCottage END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN KensingtonCedarCottage END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN KensingtonCedarCottage END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 2477 then KensingtonCedarCottage end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 2477 then KensingtonCedarCottage end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 2477 then KensingtonCedarCottage end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 2477 then KensingtonCedarCottage end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 2477 then KensingtonCedarCottage end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_black,
       cast(max(case when ID = 3085 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_arab,
       cast(max(case when ID = 3088 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_korean,
       cast(max(case when ID = 3091 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 3094 then KensingtonCedarCottage end) + max(case when ID = 3081 then KensingtonCedarCottage end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4018 then KensingtonCedarCottage end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4018 then KensingtonCedarCottage end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4042 then KensingtonCedarCottage end) + max(case when ID = 4043 then KensingtonCedarCottage end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4042 then KensingtonCedarCottage end) + max(case when ID = 4043 then KensingtonCedarCottage end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4093 then KensingtonCedarCottage end) + max(case when ID = 4094 then KensingtonCedarCottage end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4093 then KensingtonCedarCottage end) + max(case when ID = 4094 then KensingtonCedarCottage end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then KensingtonCedarCottage end) as median_rent,
       max(case when ID = 4107 then KensingtonCedarCottage end) as average_rent,
       cast(max(case when ID = 4109 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4108 then KensingtonCedarCottage end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4108 then KensingtonCedarCottage end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4108 then KensingtonCedarCottage end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4108 then KensingtonCedarCottage end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4108 then KensingtonCedarCottage end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4108 then KensingtonCedarCottage end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then KensingtonCedarCottage end) as float) / cast(max(case when ID = 4108 then KensingtonCedarCottage end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
ke as (SELECT 'Kerrisdale' AS locale,
       MAX(CASE WHEN ID = 94 THEN Kerrisdale END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Kerrisdale END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Kerrisdale END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Kerrisdale END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Kerrisdale END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Kerrisdale END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Kerrisdale END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Kerrisdale END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Kerrisdale END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Kerrisdale END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Kerrisdale END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Kerrisdale END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Kerrisdale END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Kerrisdale END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kerrisdale END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Kerrisdale END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kerrisdale END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Kerrisdale END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kerrisdale END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Kerrisdale END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kerrisdale END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Kerrisdale END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kerrisdale END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Kerrisdale END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kerrisdale END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Kerrisdale end) as float) / cast(max(case when ID = 2477 then Kerrisdale end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Kerrisdale end) as float) / cast(max(case when ID = 2477 then Kerrisdale end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Kerrisdale end) as float) / cast(max(case when ID = 2477 then Kerrisdale end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Kerrisdale end) as float) / cast(max(case when ID = 2477 then Kerrisdale end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Kerrisdale end) as float) / cast(max(case when ID = 2477 then Kerrisdale end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_black,
       cast(max(case when ID = 3085 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Kerrisdale end) as float) / cast(max(case when ID = 3094 then Kerrisdale end) + max(case when ID = 3081 then Kerrisdale end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Kerrisdale end) as float) / cast(max(case when ID = 4018 then Kerrisdale end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Kerrisdale end) as float) / cast(max(case when ID = 4018 then Kerrisdale end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Kerrisdale end) as float) / cast(max(case when ID = 4042 then Kerrisdale end) + max(case when ID = 4043 then Kerrisdale end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Kerrisdale end) as float) / cast(max(case when ID = 4042 then Kerrisdale end) + max(case when ID = 4043 then Kerrisdale end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Kerrisdale end) as float) / cast(max(case when ID = 4093 then Kerrisdale end) + max(case when ID = 4094 then Kerrisdale end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Kerrisdale end) as float) / cast(max(case when ID = 4093 then Kerrisdale end) + max(case when ID = 4094 then Kerrisdale end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Kerrisdale end) as median_rent,
       max(case when ID = 4107 then Kerrisdale end) as average_rent,
       cast(max(case when ID = 4109 then Kerrisdale end) as float) / cast(max(case when ID = 4108 then Kerrisdale end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Kerrisdale end) as float) / cast(max(case when ID = 4108 then Kerrisdale end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Kerrisdale end) as float) / cast(max(case when ID = 4108 then Kerrisdale end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Kerrisdale end) as float) / cast(max(case when ID = 4108 then Kerrisdale end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Kerrisdale end) as float) / cast(max(case when ID = 4108 then Kerrisdale end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Kerrisdale end) as float) / cast(max(case when ID = 4108 then Kerrisdale end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Kerrisdale end) as float) / cast(max(case when ID = 4108 then Kerrisdale end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
kil as (SELECT 'Killarney' AS locale,
       MAX(CASE WHEN ID = 94 THEN Killarney END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Killarney END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Killarney END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Killarney END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Killarney END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Killarney END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Killarney END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Killarney END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Killarney END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Killarney END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Killarney END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Killarney END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Killarney END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Killarney END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Killarney END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Killarney END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Killarney END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Killarney END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Killarney END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Killarney END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Killarney END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Killarney END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Killarney END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Killarney END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Killarney END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Killarney end) as float) / cast(max(case when ID = 2477 then Killarney end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Killarney end) as float) / cast(max(case when ID = 2477 then Killarney end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Killarney end) as float) / cast(max(case when ID = 2477 then Killarney end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Killarney end) as float) / cast(max(case when ID = 2477 then Killarney end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Killarney end) as float) / cast(max(case when ID = 2477 then Killarney end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_black,
       cast(max(case when ID = 3085 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Killarney end) as float) / cast(max(case when ID = 3094 then Killarney end) + max(case when ID = 3081 then Killarney end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Killarney end) as float) / cast(max(case when ID = 4018 then Killarney end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Killarney end) as float) / cast(max(case when ID = 4018 then Killarney end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Killarney end) as float) / cast(max(case when ID = 4042 then Killarney end) + max(case when ID = 4043 then Killarney end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Killarney end) as float) / cast(max(case when ID = 4042 then Killarney end) + max(case when ID = 4043 then Killarney end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Killarney end) as float) / cast(max(case when ID = 4093 then Killarney end) + max(case when ID = 4094 then Killarney end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Killarney end) as float) / cast(max(case when ID = 4093 then Killarney end) + max(case when ID = 4094 then Killarney end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Killarney end) as median_rent,
       max(case when ID = 4107 then Killarney end) as average_rent,
       cast(max(case when ID = 4109 then Killarney end) as float) / cast(max(case when ID = 4108 then Killarney end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Killarney end) as float) / cast(max(case when ID = 4108 then Killarney end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Killarney end) as float) / cast(max(case when ID = 4108 then Killarney end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Killarney end) as float) / cast(max(case when ID = 4108 then Killarney end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Killarney end) as float) / cast(max(case when ID = 4108 then Killarney end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Killarney end) as float) / cast(max(case when ID = 4108 then Killarney end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Killarney end) as float) / cast(max(case when ID = 4108 then Killarney end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
kit as (SELECT 'Kitsilano' AS locale,
       MAX(CASE WHEN ID = 94 THEN Kitsilano END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Kitsilano END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Kitsilano END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Kitsilano END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Kitsilano END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Kitsilano END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Kitsilano END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Kitsilano END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Kitsilano END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Kitsilano END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Kitsilano END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Kitsilano END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Kitsilano END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Kitsilano END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kitsilano END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Kitsilano END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kitsilano END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Kitsilano END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kitsilano END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Kitsilano END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kitsilano END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Kitsilano END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kitsilano END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Kitsilano END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Kitsilano END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Kitsilano end) as float) / cast(max(case when ID = 2477 then Kitsilano end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Kitsilano end) as float) / cast(max(case when ID = 2477 then Kitsilano end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Kitsilano end) as float) / cast(max(case when ID = 2477 then Kitsilano end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Kitsilano end) as float) / cast(max(case when ID = 2477 then Kitsilano end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Kitsilano end) as float) / cast(max(case when ID = 2477 then Kitsilano end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_black,
       cast(max(case when ID = 3085 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Kitsilano end) as float) / cast(max(case when ID = 3094 then Kitsilano end) + max(case when ID = 3081 then Kitsilano end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Kitsilano end) as float) / cast(max(case when ID = 4018 then Kitsilano end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Kitsilano end) as float) / cast(max(case when ID = 4018 then Kitsilano end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Kitsilano end) as float) / cast(max(case when ID = 4042 then Kitsilano end) + max(case when ID = 4043 then Kitsilano end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Kitsilano end) as float) / cast(max(case when ID = 4042 then Kitsilano end) + max(case when ID = 4043 then Kitsilano end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Kitsilano end) as float) / cast(max(case when ID = 4093 then Kitsilano end) + max(case when ID = 4094 then Kitsilano end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Kitsilano end) as float) / cast(max(case when ID = 4093 then Kitsilano end) + max(case when ID = 4094 then Kitsilano end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Kitsilano end) as median_rent,
       max(case when ID = 4107 then Kitsilano end) as average_rent,
       cast(max(case when ID = 4109 then Kitsilano end) as float) / cast(max(case when ID = 4108 then Kitsilano end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Kitsilano end) as float) / cast(max(case when ID = 4108 then Kitsilano end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Kitsilano end) as float) / cast(max(case when ID = 4108 then Kitsilano end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Kitsilano end) as float) / cast(max(case when ID = 4108 then Kitsilano end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Kitsilano end) as float) / cast(max(case when ID = 4108 then Kitsilano end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Kitsilano end) as float) / cast(max(case when ID = 4108 then Kitsilano end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Kitsilano end) as float) / cast(max(case when ID = 4108 then Kitsilano end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
ma as (SELECT 'Marpole' AS locale,
       MAX(CASE WHEN ID = 94 THEN Marpole END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Marpole END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Marpole END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Marpole END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Marpole END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Marpole END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Marpole END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Marpole END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Marpole END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Marpole END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Marpole END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Marpole END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Marpole END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Marpole END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Marpole END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Marpole END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Marpole END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Marpole END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Marpole END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Marpole END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Marpole END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Marpole END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Marpole END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Marpole END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Marpole END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Marpole end) as float) / cast(max(case when ID = 2477 then Marpole end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Marpole end) as float) / cast(max(case when ID = 2477 then Marpole end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Marpole end) as float) / cast(max(case when ID = 2477 then Marpole end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Marpole end) as float) / cast(max(case when ID = 2477 then Marpole end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Marpole end) as float) / cast(max(case when ID = 2477 then Marpole end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_black,
       cast(max(case when ID = 3085 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Marpole end) as float) / cast(max(case when ID = 3094 then Marpole end) + max(case when ID = 3081 then Marpole end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Marpole end) as float) / cast(max(case when ID = 4018 then Marpole end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Marpole end) as float) / cast(max(case when ID = 4018 then Marpole end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Marpole end) as float) / cast(max(case when ID = 4042 then Marpole end) + max(case when ID = 4043 then Marpole end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Marpole end) as float) / cast(max(case when ID = 4042 then Marpole end) + max(case when ID = 4043 then Marpole end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Marpole end) as float) / cast(max(case when ID = 4093 then Marpole end) + max(case when ID = 4094 then Marpole end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Marpole end) as float) / cast(max(case when ID = 4093 then Marpole end) + max(case when ID = 4094 then Marpole end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Marpole end) as median_rent,
       max(case when ID = 4107 then Marpole end) as average_rent,
       cast(max(case when ID = 4109 then Marpole end) as float) / cast(max(case when ID = 4108 then Marpole end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Marpole end) as float) / cast(max(case when ID = 4108 then Marpole end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Marpole end) as float) / cast(max(case when ID = 4108 then Marpole end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Marpole end) as float) / cast(max(case when ID = 4108 then Marpole end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Marpole end) as float) / cast(max(case when ID = 4108 then Marpole end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Marpole end) as float) / cast(max(case when ID = 4108 then Marpole end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Marpole end) as float) / cast(max(case when ID = 4108 then Marpole end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
mp as (SELECT 'MountPleasant' AS locale,
       MAX(CASE WHEN ID = 94 THEN MountPleasant END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN MountPleasant END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN MountPleasant END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN MountPleasant END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN MountPleasant END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN MountPleasant END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN MountPleasant END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN MountPleasant END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN MountPleasant END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN MountPleasant END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN MountPleasant END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN MountPleasant END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN MountPleasant END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN MountPleasant END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN MountPleasant END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN MountPleasant END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN MountPleasant END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN MountPleasant END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN MountPleasant END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN MountPleasant END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN MountPleasant END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN MountPleasant END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN MountPleasant END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN MountPleasant END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN MountPleasant END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then MountPleasant end) as float) / cast(max(case when ID = 2477 then MountPleasant end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then MountPleasant end) as float) / cast(max(case when ID = 2477 then MountPleasant end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then MountPleasant end) as float) / cast(max(case when ID = 2477 then MountPleasant end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then MountPleasant end) as float) / cast(max(case when ID = 2477 then MountPleasant end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then MountPleasant end) as float) / cast(max(case when ID = 2477 then MountPleasant end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_black,
       cast(max(case when ID = 3085 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_arab,
       cast(max(case when ID = 3088 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_korean,
       cast(max(case when ID = 3091 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then MountPleasant end) as float) / cast(max(case when ID = 3094 then MountPleasant end) + max(case when ID = 3081 then MountPleasant end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then MountPleasant end) as float) / cast(max(case when ID = 4018 then MountPleasant end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then MountPleasant end) as float) / cast(max(case when ID = 4018 then MountPleasant end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then MountPleasant end) as float) / cast(max(case when ID = 4042 then MountPleasant end) + max(case when ID = 4043 then MountPleasant end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then MountPleasant end) as float) / cast(max(case when ID = 4042 then MountPleasant end) + max(case when ID = 4043 then MountPleasant end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then MountPleasant end) as float) / cast(max(case when ID = 4093 then MountPleasant end) + max(case when ID = 4094 then MountPleasant end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then MountPleasant end) as float) / cast(max(case when ID = 4093 then MountPleasant end) + max(case when ID = 4094 then MountPleasant end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then MountPleasant end) as median_rent,
       max(case when ID = 4107 then MountPleasant end) as average_rent,
       cast(max(case when ID = 4109 then MountPleasant end) as float) / cast(max(case when ID = 4108 then MountPleasant end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then MountPleasant end) as float) / cast(max(case when ID = 4108 then MountPleasant end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then MountPleasant end) as float) / cast(max(case when ID = 4108 then MountPleasant end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then MountPleasant end) as float) / cast(max(case when ID = 4108 then MountPleasant end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then MountPleasant end) as float) / cast(max(case when ID = 4108 then MountPleasant end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then MountPleasant end) as float) / cast(max(case when ID = 4108 then MountPleasant end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then MountPleasant end) as float) / cast(max(case when ID = 4108 then MountPleasant end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
oa as (SELECT 'Oakridge' AS locale,
       MAX(CASE WHEN ID = 94 THEN Oakridge END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Oakridge END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Oakridge END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Oakridge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Oakridge END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Oakridge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Oakridge END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Oakridge END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Oakridge END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Oakridge END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Oakridge END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Oakridge END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Oakridge END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Oakridge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Oakridge END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Oakridge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Oakridge END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Oakridge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Oakridge END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Oakridge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Oakridge END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Oakridge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Oakridge END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Oakridge END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Oakridge END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Oakridge end) as float) / cast(max(case when ID = 2477 then Oakridge end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Oakridge end) as float) / cast(max(case when ID = 2477 then Oakridge end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Oakridge end) as float) / cast(max(case when ID = 2477 then Oakridge end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Oakridge end) as float) / cast(max(case when ID = 2477 then Oakridge end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Oakridge end) as float) / cast(max(case when ID = 2477 then Oakridge end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_black,
       cast(max(case when ID = 3085 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Oakridge end) as float) / cast(max(case when ID = 3094 then Oakridge end) + max(case when ID = 3081 then Oakridge end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Oakridge end) as float) / cast(max(case when ID = 4018 then Oakridge end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Oakridge end) as float) / cast(max(case when ID = 4018 then Oakridge end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Oakridge end) as float) / cast(max(case when ID = 4042 then Oakridge end) + max(case when ID = 4043 then Oakridge end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Oakridge end) as float) / cast(max(case when ID = 4042 then Oakridge end) + max(case when ID = 4043 then Oakridge end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Oakridge end) as float) / cast(max(case when ID = 4093 then Oakridge end) + max(case when ID = 4094 then Oakridge end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Oakridge end) as float) / cast(max(case when ID = 4093 then Oakridge end) + max(case when ID = 4094 then Oakridge end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Oakridge end) as median_rent,
       max(case when ID = 4107 then Oakridge end) as average_rent,
       cast(max(case when ID = 4109 then Oakridge end) as float) / cast(max(case when ID = 4108 then Oakridge end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Oakridge end) as float) / cast(max(case when ID = 4108 then Oakridge end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Oakridge end) as float) / cast(max(case when ID = 4108 then Oakridge end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Oakridge end) as float) / cast(max(case when ID = 4108 then Oakridge end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Oakridge end) as float) / cast(max(case when ID = 4108 then Oakridge end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Oakridge end) as float) / cast(max(case when ID = 4108 then Oakridge end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Oakridge end) as float) / cast(max(case when ID = 4108 then Oakridge end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
rc as (SELECT 'RenfrewCollingwood' AS locale,
       MAX(CASE WHEN ID = 94 THEN RenfrewCollingwood END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN RenfrewCollingwood END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN RenfrewCollingwood END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN RenfrewCollingwood END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN RenfrewCollingwood END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN RenfrewCollingwood END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN RenfrewCollingwood END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN RenfrewCollingwood END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN RenfrewCollingwood END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN RenfrewCollingwood END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN RenfrewCollingwood END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN RenfrewCollingwood END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN RenfrewCollingwood END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN RenfrewCollingwood END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RenfrewCollingwood END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN RenfrewCollingwood END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RenfrewCollingwood END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN RenfrewCollingwood END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RenfrewCollingwood END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN RenfrewCollingwood END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RenfrewCollingwood END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN RenfrewCollingwood END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RenfrewCollingwood END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN RenfrewCollingwood END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RenfrewCollingwood END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then RenfrewCollingwood end) as float) / cast(max(case when ID = 2477 then RenfrewCollingwood end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then RenfrewCollingwood end) as float) / cast(max(case when ID = 2477 then RenfrewCollingwood end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then RenfrewCollingwood end) as float) / cast(max(case when ID = 2477 then RenfrewCollingwood end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then RenfrewCollingwood end) as float) / cast(max(case when ID = 2477 then RenfrewCollingwood end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then RenfrewCollingwood end) as float) / cast(max(case when ID = 2477 then RenfrewCollingwood end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_black,
       cast(max(case when ID = 3085 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_arab,
       cast(max(case when ID = 3088 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_korean,
       cast(max(case when ID = 3091 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then RenfrewCollingwood end) as float) / cast(max(case when ID = 3094 then RenfrewCollingwood end) + max(case when ID = 3081 then RenfrewCollingwood end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4018 then RenfrewCollingwood end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4018 then RenfrewCollingwood end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4042 then RenfrewCollingwood end) + max(case when ID = 4043 then RenfrewCollingwood end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4042 then RenfrewCollingwood end) + max(case when ID = 4043 then RenfrewCollingwood end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4093 then RenfrewCollingwood end) + max(case when ID = 4094 then RenfrewCollingwood end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4093 then RenfrewCollingwood end) + max(case when ID = 4094 then RenfrewCollingwood end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then RenfrewCollingwood end) as median_rent,
       max(case when ID = 4107 then RenfrewCollingwood end) as average_rent,
       cast(max(case when ID = 4109 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4108 then RenfrewCollingwood end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4108 then RenfrewCollingwood end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4108 then RenfrewCollingwood end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4108 then RenfrewCollingwood end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4108 then RenfrewCollingwood end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4108 then RenfrewCollingwood end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then RenfrewCollingwood end) as float) / cast(max(case when ID = 4108 then RenfrewCollingwood end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
rp as (SELECT 'RileyPark' AS locale,
       MAX(CASE WHEN ID = 94 THEN RileyPark END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN RileyPark END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN RileyPark END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN RileyPark END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN RileyPark END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN RileyPark END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN RileyPark END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN RileyPark END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN RileyPark END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN RileyPark END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN RileyPark END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN RileyPark END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN RileyPark END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN RileyPark END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RileyPark END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN RileyPark END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RileyPark END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN RileyPark END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RileyPark END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN RileyPark END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RileyPark END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN RileyPark END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RileyPark END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN RileyPark END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN RileyPark END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then RileyPark end) as float) / cast(max(case when ID = 2477 then RileyPark end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then RileyPark end) as float) / cast(max(case when ID = 2477 then RileyPark end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then RileyPark end) as float) / cast(max(case when ID = 2477 then RileyPark end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then RileyPark end) as float) / cast(max(case when ID = 2477 then RileyPark end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then RileyPark end) as float) / cast(max(case when ID = 2477 then RileyPark end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_black,
       cast(max(case when ID = 3085 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_arab,
       cast(max(case when ID = 3088 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_korean,
       cast(max(case when ID = 3091 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then RileyPark end) as float) / cast(max(case when ID = 3094 then RileyPark end) + max(case when ID = 3081 then RileyPark end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then RileyPark end) as float) / cast(max(case when ID = 4018 then RileyPark end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then RileyPark end) as float) / cast(max(case when ID = 4018 then RileyPark end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then RileyPark end) as float) / cast(max(case when ID = 4042 then RileyPark end) + max(case when ID = 4043 then RileyPark end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then RileyPark end) as float) / cast(max(case when ID = 4042 then RileyPark end) + max(case when ID = 4043 then RileyPark end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then RileyPark end) as float) / cast(max(case when ID = 4093 then RileyPark end) + max(case when ID = 4094 then RileyPark end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then RileyPark end) as float) / cast(max(case when ID = 4093 then RileyPark end) + max(case when ID = 4094 then RileyPark end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then RileyPark end) as median_rent,
       max(case when ID = 4107 then RileyPark end) as average_rent,
       cast(max(case when ID = 4109 then RileyPark end) as float) / cast(max(case when ID = 4108 then RileyPark end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then RileyPark end) as float) / cast(max(case when ID = 4108 then RileyPark end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then RileyPark end) as float) / cast(max(case when ID = 4108 then RileyPark end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then RileyPark end) as float) / cast(max(case when ID = 4108 then RileyPark end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then RileyPark end) as float) / cast(max(case when ID = 4108 then RileyPark end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then RileyPark end) as float) / cast(max(case when ID = 4108 then RileyPark end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then RileyPark end) as float) / cast(max(case when ID = 4108 then RileyPark end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
sh as (SELECT 'Shaughnessy' AS locale,
       MAX(CASE WHEN ID = 94 THEN Shaughnessy END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Shaughnessy END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Shaughnessy END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Shaughnessy END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Shaughnessy END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Shaughnessy END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Shaughnessy END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Shaughnessy END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Shaughnessy END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Shaughnessy END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Shaughnessy END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Shaughnessy END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Shaughnessy END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Shaughnessy END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Shaughnessy END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Shaughnessy END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Shaughnessy END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Shaughnessy END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Shaughnessy END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Shaughnessy END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Shaughnessy END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Shaughnessy END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Shaughnessy END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Shaughnessy END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Shaughnessy END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Shaughnessy end) as float) / cast(max(case when ID = 2477 then Shaughnessy end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Shaughnessy end) as float) / cast(max(case when ID = 2477 then Shaughnessy end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Shaughnessy end) as float) / cast(max(case when ID = 2477 then Shaughnessy end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Shaughnessy end) as float) / cast(max(case when ID = 2477 then Shaughnessy end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Shaughnessy end) as float) / cast(max(case when ID = 2477 then Shaughnessy end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_black,
       cast(max(case when ID = 3085 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Shaughnessy end) as float) / cast(max(case when ID = 3094 then Shaughnessy end) + max(case when ID = 3081 then Shaughnessy end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Shaughnessy end) as float) / cast(max(case when ID = 4018 then Shaughnessy end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Shaughnessy end) as float) / cast(max(case when ID = 4018 then Shaughnessy end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Shaughnessy end) as float) / cast(max(case when ID = 4042 then Shaughnessy end) + max(case when ID = 4043 then Shaughnessy end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Shaughnessy end) as float) / cast(max(case when ID = 4042 then Shaughnessy end) + max(case when ID = 4043 then Shaughnessy end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Shaughnessy end) as float) / cast(max(case when ID = 4093 then Shaughnessy end) + max(case when ID = 4094 then Shaughnessy end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Shaughnessy end) as float) / cast(max(case when ID = 4093 then Shaughnessy end) + max(case when ID = 4094 then Shaughnessy end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Shaughnessy end) as median_rent,
       max(case when ID = 4107 then Shaughnessy end) as average_rent,
       cast(max(case when ID = 4109 then Shaughnessy end) as float) / cast(max(case when ID = 4108 then Shaughnessy end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Shaughnessy end) as float) / cast(max(case when ID = 4108 then Shaughnessy end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Shaughnessy end) as float) / cast(max(case when ID = 4108 then Shaughnessy end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Shaughnessy end) as float) / cast(max(case when ID = 4108 then Shaughnessy end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Shaughnessy end) as float) / cast(max(case when ID = 4108 then Shaughnessy end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Shaughnessy end) as float) / cast(max(case when ID = 4108 then Shaughnessy end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Shaughnessy end) as float) / cast(max(case when ID = 4108 then Shaughnessy end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
sc as (SELECT 'SouthCambie' AS locale,
       MAX(CASE WHEN ID = 94 THEN SouthCambie END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN SouthCambie END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN SouthCambie END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN SouthCambie END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN SouthCambie END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN SouthCambie END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN SouthCambie END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN SouthCambie END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN SouthCambie END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN SouthCambie END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN SouthCambie END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN SouthCambie END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN SouthCambie END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN SouthCambie END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN SouthCambie END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN SouthCambie END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN SouthCambie END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN SouthCambie END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN SouthCambie END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN SouthCambie END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN SouthCambie END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN SouthCambie END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN SouthCambie END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN SouthCambie END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN SouthCambie END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then SouthCambie end) as float) / cast(max(case when ID = 2477 then SouthCambie end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then SouthCambie end) as float) / cast(max(case when ID = 2477 then SouthCambie end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then SouthCambie end) as float) / cast(max(case when ID = 2477 then SouthCambie end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then SouthCambie end) as float) / cast(max(case when ID = 2477 then SouthCambie end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then SouthCambie end) as float) / cast(max(case when ID = 2477 then SouthCambie end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_black,
       cast(max(case when ID = 3085 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_arab,
       cast(max(case when ID = 3088 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_korean,
       cast(max(case when ID = 3091 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then SouthCambie end) as float) / cast(max(case when ID = 3094 then SouthCambie end) + max(case when ID = 3081 then SouthCambie end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then SouthCambie end) as float) / cast(max(case when ID = 4018 then SouthCambie end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then SouthCambie end) as float) / cast(max(case when ID = 4018 then SouthCambie end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then SouthCambie end) as float) / cast(max(case when ID = 4042 then SouthCambie end) + max(case when ID = 4043 then SouthCambie end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then SouthCambie end) as float) / cast(max(case when ID = 4042 then SouthCambie end) + max(case when ID = 4043 then SouthCambie end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then SouthCambie end) as float) / cast(max(case when ID = 4093 then SouthCambie end) + max(case when ID = 4094 then SouthCambie end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then SouthCambie end) as float) / cast(max(case when ID = 4093 then SouthCambie end) + max(case when ID = 4094 then SouthCambie end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then SouthCambie end) as median_rent,
       max(case when ID = 4107 then SouthCambie end) as average_rent,
       cast(max(case when ID = 4109 then SouthCambie end) as float) / cast(max(case when ID = 4108 then SouthCambie end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then SouthCambie end) as float) / cast(max(case when ID = 4108 then SouthCambie end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then SouthCambie end) as float) / cast(max(case when ID = 4108 then SouthCambie end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then SouthCambie end) as float) / cast(max(case when ID = 4108 then SouthCambie end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then SouthCambie end) as float) / cast(max(case when ID = 4108 then SouthCambie end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then SouthCambie end) as float) / cast(max(case when ID = 4108 then SouthCambie end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then SouthCambie end) as float) / cast(max(case when ID = 4108 then SouthCambie end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
st as (SELECT 'Strathcona' AS locale,
       MAX(CASE WHEN ID = 94 THEN Strathcona END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Strathcona END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Strathcona END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Strathcona END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Strathcona END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Strathcona END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Strathcona END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Strathcona END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Strathcona END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Strathcona END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Strathcona END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Strathcona END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Strathcona END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Strathcona END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Strathcona END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Strathcona END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Strathcona END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Strathcona END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Strathcona END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Strathcona END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Strathcona END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Strathcona END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Strathcona END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Strathcona END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Strathcona END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Strathcona end) as float) / cast(max(case when ID = 2477 then Strathcona end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Strathcona end) as float) / cast(max(case when ID = 2477 then Strathcona end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Strathcona end) as float) / cast(max(case when ID = 2477 then Strathcona end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Strathcona end) as float) / cast(max(case when ID = 2477 then Strathcona end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Strathcona end) as float) / cast(max(case when ID = 2477 then Strathcona end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_black,
       cast(max(case when ID = 3085 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Strathcona end) as float) / cast(max(case when ID = 3094 then Strathcona end) + max(case when ID = 3081 then Strathcona end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Strathcona end) as float) / cast(max(case when ID = 4018 then Strathcona end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Strathcona end) as float) / cast(max(case when ID = 4018 then Strathcona end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Strathcona end) as float) / cast(max(case when ID = 4042 then Strathcona end) + max(case when ID = 4043 then Strathcona end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Strathcona end) as float) / cast(max(case when ID = 4042 then Strathcona end) + max(case when ID = 4043 then Strathcona end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Strathcona end) as float) / cast(max(case when ID = 4093 then Strathcona end) + max(case when ID = 4094 then Strathcona end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Strathcona end) as float) / cast(max(case when ID = 4093 then Strathcona end) + max(case when ID = 4094 then Strathcona end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Strathcona end) as median_rent,
       max(case when ID = 4107 then Strathcona end) as average_rent,
       cast(max(case when ID = 4109 then Strathcona end) as float) / cast(max(case when ID = 4108 then Strathcona end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Strathcona end) as float) / cast(max(case when ID = 4108 then Strathcona end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Strathcona end) as float) / cast(max(case when ID = 4108 then Strathcona end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Strathcona end) as float) / cast(max(case when ID = 4108 then Strathcona end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Strathcona end) as float) / cast(max(case when ID = 4108 then Strathcona end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Strathcona end) as float) / cast(max(case when ID = 4108 then Strathcona end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Strathcona end) as float) / cast(max(case when ID = 4108 then Strathcona end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
su as (SELECT 'Sunset' AS locale,
       MAX(CASE WHEN ID = 94 THEN Sunset END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN Sunset END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN Sunset END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN Sunset END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Sunset END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN Sunset END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN Sunset END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN Sunset END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN Sunset END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN Sunset END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN Sunset END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN Sunset END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN Sunset END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN Sunset END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Sunset END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN Sunset END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Sunset END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN Sunset END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Sunset END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN Sunset END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Sunset END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN Sunset END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Sunset END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN Sunset END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN Sunset END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then Sunset end) as float) / cast(max(case when ID = 2477 then Sunset end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then Sunset end) as float) / cast(max(case when ID = 2477 then Sunset end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then Sunset end) as float) / cast(max(case when ID = 2477 then Sunset end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then Sunset end) as float) / cast(max(case when ID = 2477 then Sunset end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then Sunset end) as float) / cast(max(case when ID = 2477 then Sunset end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_black,
       cast(max(case when ID = 3085 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_arab,
       cast(max(case when ID = 3088 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_korean,
       cast(max(case when ID = 3091 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then Sunset end) as float) / cast(max(case when ID = 3094 then Sunset end) + max(case when ID = 3081 then Sunset end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then Sunset end) as float) / cast(max(case when ID = 4018 then Sunset end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then Sunset end) as float) / cast(max(case when ID = 4018 then Sunset end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then Sunset end) as float) / cast(max(case when ID = 4042 then Sunset end) + max(case when ID = 4043 then Sunset end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then Sunset end) as float) / cast(max(case when ID = 4042 then Sunset end) + max(case when ID = 4043 then Sunset end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then Sunset end) as float) / cast(max(case when ID = 4093 then Sunset end) + max(case when ID = 4094 then Sunset end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then Sunset end) as float) / cast(max(case when ID = 4093 then Sunset end) + max(case when ID = 4094 then Sunset end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then Sunset end) as median_rent,
       max(case when ID = 4107 then Sunset end) as average_rent,
       cast(max(case when ID = 4109 then Sunset end) as float) / cast(max(case when ID = 4108 then Sunset end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then Sunset end) as float) / cast(max(case when ID = 4108 then Sunset end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then Sunset end) as float) / cast(max(case when ID = 4108 then Sunset end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then Sunset end) as float) / cast(max(case when ID = 4108 then Sunset end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then Sunset end) as float) / cast(max(case when ID = 4108 then Sunset end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then Sunset end) as float) / cast(max(case when ID = 4108 then Sunset end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then Sunset end) as float) / cast(max(case when ID = 4108 then Sunset end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
vf as (SELECT 'VictoriaFraserview' AS locale,
       MAX(CASE WHEN ID = 94 THEN VictoriaFraserview END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN VictoriaFraserview END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN VictoriaFraserview END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN VictoriaFraserview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN VictoriaFraserview END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN VictoriaFraserview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN VictoriaFraserview END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN VictoriaFraserview END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN VictoriaFraserview END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN VictoriaFraserview END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN VictoriaFraserview END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN VictoriaFraserview END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN VictoriaFraserview END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN VictoriaFraserview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN VictoriaFraserview END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN VictoriaFraserview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN VictoriaFraserview END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN VictoriaFraserview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN VictoriaFraserview END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN VictoriaFraserview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN VictoriaFraserview END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN VictoriaFraserview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN VictoriaFraserview END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN VictoriaFraserview END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN VictoriaFraserview END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then VictoriaFraserview end) as float) / cast(max(case when ID = 2477 then VictoriaFraserview end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then VictoriaFraserview end) as float) / cast(max(case when ID = 2477 then VictoriaFraserview end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then VictoriaFraserview end) as float) / cast(max(case when ID = 2477 then VictoriaFraserview end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then VictoriaFraserview end) as float) / cast(max(case when ID = 2477 then VictoriaFraserview end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then VictoriaFraserview end) as float) / cast(max(case when ID = 2477 then VictoriaFraserview end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_black,
       cast(max(case when ID = 3085 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_arab,
       cast(max(case when ID = 3088 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_korean,
       cast(max(case when ID = 3091 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then VictoriaFraserview end) as float) / cast(max(case when ID = 3094 then VictoriaFraserview end) + max(case when ID = 3081 then VictoriaFraserview end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then VictoriaFraserview end) as float) / cast(max(case when ID = 4018 then VictoriaFraserview end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then VictoriaFraserview end) as float) / cast(max(case when ID = 4018 then VictoriaFraserview end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then VictoriaFraserview end) as float) / cast(max(case when ID = 4042 then VictoriaFraserview end) + max(case when ID = 4043 then VictoriaFraserview end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then VictoriaFraserview end) as float) / cast(max(case when ID = 4042 then VictoriaFraserview end) + max(case when ID = 4043 then VictoriaFraserview end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then VictoriaFraserview end) as float) / cast(max(case when ID = 4093 then VictoriaFraserview end) + max(case when ID = 4094 then VictoriaFraserview end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then VictoriaFraserview end) as float) / cast(max(case when ID = 4093 then VictoriaFraserview end) + max(case when ID = 4094 then VictoriaFraserview end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then VictoriaFraserview end) as median_rent,
       max(case when ID = 4107 then VictoriaFraserview end) as average_rent,
       cast(max(case when ID = 4109 then VictoriaFraserview end) as float) / cast(max(case when ID = 4108 then VictoriaFraserview end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then VictoriaFraserview end) as float) / cast(max(case when ID = 4108 then VictoriaFraserview end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then VictoriaFraserview end) as float) / cast(max(case when ID = 4108 then VictoriaFraserview end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then VictoriaFraserview end) as float) / cast(max(case when ID = 4108 then VictoriaFraserview end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then VictoriaFraserview end) as float) / cast(max(case when ID = 4108 then VictoriaFraserview end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then VictoriaFraserview end) as float) / cast(max(case when ID = 4108 then VictoriaFraserview end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then VictoriaFraserview end) as float) / cast(max(case when ID = 4108 then VictoriaFraserview end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
we as (SELECT 'WestEnd' AS locale,
       MAX(CASE WHEN ID = 94 THEN WestEnd END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN WestEnd END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN WestEnd END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN WestEnd END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN WestEnd END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN WestEnd END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN WestEnd END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN WestEnd END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN WestEnd END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN WestEnd END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN WestEnd END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN WestEnd END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN WestEnd END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN WestEnd END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestEnd END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN WestEnd END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestEnd END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN WestEnd END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestEnd END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN WestEnd END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestEnd END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN WestEnd END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestEnd END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN WestEnd END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestEnd END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then WestEnd end) as float) / cast(max(case when ID = 2477 then WestEnd end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then WestEnd end) as float) / cast(max(case when ID = 2477 then WestEnd end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then WestEnd end) as float) / cast(max(case when ID = 2477 then WestEnd end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then WestEnd end) as float) / cast(max(case when ID = 2477 then WestEnd end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then WestEnd end) as float) / cast(max(case when ID = 2477 then WestEnd end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_black,
       cast(max(case when ID = 3085 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_arab,
       cast(max(case when ID = 3088 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_korean,
       cast(max(case when ID = 3091 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then WestEnd end) as float) / cast(max(case when ID = 3094 then WestEnd end) + max(case when ID = 3081 then WestEnd end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then WestEnd end) as float) / cast(max(case when ID = 4018 then WestEnd end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then WestEnd end) as float) / cast(max(case when ID = 4018 then WestEnd end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then WestEnd end) as float) / cast(max(case when ID = 4042 then WestEnd end) + max(case when ID = 4043 then WestEnd end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then WestEnd end) as float) / cast(max(case when ID = 4042 then WestEnd end) + max(case when ID = 4043 then WestEnd end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then WestEnd end) as float) / cast(max(case when ID = 4093 then WestEnd end) + max(case when ID = 4094 then WestEnd end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then WestEnd end) as float) / cast(max(case when ID = 4093 then WestEnd end) + max(case when ID = 4094 then WestEnd end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then WestEnd end) as median_rent,
       max(case when ID = 4107 then WestEnd end) as average_rent,
       cast(max(case when ID = 4109 then WestEnd end) as float) / cast(max(case when ID = 4108 then WestEnd end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then WestEnd end) as float) / cast(max(case when ID = 4108 then WestEnd end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then WestEnd end) as float) / cast(max(case when ID = 4108 then WestEnd end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then WestEnd end) as float) / cast(max(case when ID = 4108 then WestEnd end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then WestEnd end) as float) / cast(max(case when ID = 4108 then WestEnd end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then WestEnd end) as float) / cast(max(case when ID = 4108 then WestEnd end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then WestEnd end) as float) / cast(max(case when ID = 4108 then WestEnd end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale),
wp as (SELECT 'WestPointGrey' AS locale,
       MAX(CASE WHEN ID = 94 THEN WestPointGrey END) AS avg_pop_age,
       MAX(CASE WHEN ID = 95 THEN WestPointGrey END) AS med_pop_age,
       MAX(CASE WHEN ID = 157 THEN WestPointGrey END) AS avg_household_size,
       CAST(SUM(CASE WHEN ID = 167 THEN WestPointGrey END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN WestPointGrey END) AS FLOAT) AS percent_dwelling_single_detached,
       CAST(SUM(CASE WHEN ID IN (168,172,173) THEN WestPointGrey END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 166 THEN WestPointGrey END) AS FLOAT) AS percent_dwelling_apts,
       MAX(CASE WHEN ID = 1874 THEN WestPointGrey END) AS avg_total_individual_income,
       MAX(CASE WHEN ID = 1875 THEN WestPointGrey END) AS med_total_individual_income,
       MAX(CASE WHEN ID = 3963 THEN WestPointGrey END) AS avg_total_household_income,
       MAX(CASE WHEN ID = 3964 THEN WestPointGrey END) AS med_total_household_income,
       MAX(CASE WHEN ID = 1886 THEN WestPointGrey END) AS avg_total_employment_income,
       MAX(CASE WHEN ID = 1887 THEN WestPointGrey END) AS med_total_employment_income,
       CAST(MAX(CASE WHEN ID = 2314 THEN WestPointGrey END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestPointGrey END) AS FLOAT) AS percent_commute_drive,
       CAST(MAX(CASE WHEN ID = 2315 THEN WestPointGrey END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestPointGrey END) AS FLOAT) AS percent_commute_pool,
       CAST(MAX(CASE WHEN ID = 2316 THEN WestPointGrey END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestPointGrey END) AS FLOAT) AS percent_commute_transit,
       CAST(MAX(CASE WHEN ID = 2317 THEN WestPointGrey END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestPointGrey END) AS FLOAT) AS percent_commute_walk,
       CAST(MAX(CASE WHEN ID = 2318 THEN WestPointGrey END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestPointGrey END) AS FLOAT) AS percent_commute_bicycle,
       CAST(MAX(CASE WHEN ID = 2319 THEN WestPointGrey END) AS FLOAT) / CAST(MAX(CASE WHEN ID = 2313 THEN WestPointGrey END) AS FLOAT) AS percent_commute_other,
       cast(max(case when ID = 2478 then WestPointGrey end) as float) / cast(max(case when ID = 2477 then WestPointGrey end) as float) as percent_commute_0_14,
       cast(max(case when ID = 2479 then WestPointGrey end) as float) / cast(max(case when ID = 2477 then WestPointGrey end) as float) as percent_commute_15_29,
       cast(max(case when ID = 2480 then WestPointGrey end) as float) / cast(max(case when ID = 2477 then WestPointGrey end) as float) as percent_commute_30_44,
       cast(max(case when ID = 2481 then WestPointGrey end) as float) / cast(max(case when ID = 2477 then WestPointGrey end) as float) as percent_commute_45_59,
       cast(max(case when ID = 2482 then WestPointGrey end) as float) / cast(max(case when ID = 2477 then WestPointGrey end) as float) as percent_commute_60_,
       cast(max(case when ID = 3081 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_visible_minority,
       cast(max(case when ID = 3082 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_south_asian,
       cast(max(case when ID = 3083 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_chinese,
       cast(max(case when ID = 3084 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_black,
       cast(max(case when ID = 3085 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_filipino,
       cast(max(case when ID = 3086 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_latin_american,
       cast(max(case when ID = 3087 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_arab,
       cast(max(case when ID = 3088 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_southeast_asian,
       cast(max(case when ID = 3089 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_west_asian,
       cast(max(case when ID = 3090 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_korean,
       cast(max(case when ID = 3091 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_japanese,
       cast(max(case when ID = 3092 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_vis_min_nie,
       cast(max(case when ID = 3093 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_vis_min_mult,
       cast(max(case when ID = 3094 then WestPointGrey end) as float) / cast(max(case when ID = 3094 then WestPointGrey end) + max(case when ID = 3081 then WestPointGrey end) as float) as percent_not_vis_min,
       cast(max(case when ID = 4019 then WestPointGrey end) as float) / cast(max(case when ID = 4018 then WestPointGrey end) as float) as percent_home_owner,
       cast(max(case when ID = 4020 then WestPointGrey end) as float) / cast(max(case when ID = 4018 then WestPointGrey end) as float) as percent_home_renter,
       cast(max(case when ID = 4042 then WestPointGrey end) as float) / cast(max(case when ID = 4042 then WestPointGrey end) + max(case when ID = 4043 then WestPointGrey end) as float) as percent_suitable_housing,
       cast(max(case when ID = 4043 then WestPointGrey end) as float) / cast(max(case when ID = 4042 then WestPointGrey end) + max(case when ID = 4043 then WestPointGrey end) as float) as percent_unsuitable_housing,
       cast(max(case when ID = 4093 then WestPointGrey end) as float) / cast(max(case when ID = 4093 then WestPointGrey end) + max(case when ID = 4094 then WestPointGrey end) as float) as percent_under_30_percent_housing,
       cast(max(case when ID = 4094 then WestPointGrey end) as float) / cast(max(case when ID = 4093 then WestPointGrey end) + max(case when ID = 4094 then WestPointGrey end) as float) as percent_over_30_percent_housing,
       max(case when ID = 4106 then WestPointGrey end) as median_rent,
       max(case when ID = 4107 then WestPointGrey end) as average_rent,
       cast(max(case when ID = 4109 then WestPointGrey end) as float) / cast(max(case when ID = 4108 then WestPointGrey end) as float) as percent_no_diploma,
       cast(max(case when ID = 4110 then WestPointGrey end) as float) / cast(max(case when ID = 4108 then WestPointGrey end) as float) as percent_high_school_diploma,
       cast(max(case when ID = 4111 then WestPointGrey end) as float) / cast(max(case when ID = 4108 then WestPointGrey end) as float) as percent_post_secondary_diploma_degree,
       cast(max(case when ID = 4112 then WestPointGrey end) as float) / cast(max(case when ID = 4108 then WestPointGrey end) as float) as percent_trades_diploma,
       cast(max(case when ID = 4118 then WestPointGrey end) as float) / cast(max(case when ID = 4108 then WestPointGrey end) as float) as percent_bachelors_degree,
       cast(max(case when ID = 4121 then WestPointGrey end) as float) / cast(max(case when ID = 4108 then WestPointGrey end) as float) as percent_masters_degree,
       cast(max(case when ID = 4122 then WestPointGrey end) as float) / cast(max(case when ID = 4108 then WestPointGrey end) as float) as percent_doctorate_degree
FROM df_demos
GROUP BY locale)
select * from ar
union all
select * from dt
union all
select * from ds
union all
select * from fv
union all
select * from gw
union all
select * from hs
union all
select * from kcc
union all
select * from ke
union all
select * from kil
union all
select * from kit
union all
select * from ma
union all
select * from mp
union all
select * from oa
union all
select * from rc
union all
select * from rp
union all
select * from sh
union all
select * from sc
union all
select * from st
union all
select * from su
union all
select * from vf
union all
select * from we
union all
select * from wp
LIMIT 100
